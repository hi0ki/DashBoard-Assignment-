generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model UserProfile {
  id            String   @id @default(cuid())
  clerkUserId   String   @unique @map("clerk_user_id")
  firstName     String?  @map("first_name")
  lastName      String?  @map("last_name")
  imageUrl      String?  @map("image_url")
  bio           String?
  phone         String?
  remaining     Int      @default(50)
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  lastResetDate DateTime @default(now()) @map("last_reset_date")

  @@map("user_profiles")
}

model Agency {
  id              String   @id @default(cuid())
  originalId      String?  @map("original_id")
  name            String
  state           String?
  stateCode       String?  @map("state_code")
  type            String?
  population      String?
  website         String?
  county          String?
  phone           String?
  mailingAddress  String?  @map("mailing_address")
  physicalAddress String?  @map("physical_address")
  createdAt       DateTime @default(now()) @map("created_at")

  @@map("agencies")
}

model Contact {
  id         String        @id @default(cuid())
  originalId String?       @map("original_id")
  name       String
  email      String?
  phone      String?
  position   String?
  department String?
  agency     String?
  agencyId   String?       @map("agency_id")
  notes      String?
  createdAt  DateTime      @default(now()) @map("created_at")
  views      ContactView[]

  @@map("contacts")
}

model ContactView {
  id          String   @id @default(cuid())
  contactId   String   @map("contact_id")
  clerkUserId String   @map("clerk_user_id")
  viewedAt    DateTime @default(now()) @map("viewed_at")
  contact     Contact  @relation(fields: [contactId], references: [id], onDelete: Cascade)

  @@unique([contactId, clerkUserId])
  @@map("contact_views")
}
